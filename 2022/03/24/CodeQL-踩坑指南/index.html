<!DOCTYPE HTML>
<html>

<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Title -->
    
    <title>CodeQL 踩坑指南 | DV.K</title>
    <meta charset="utf-8" />
    <meta name="google-site-verification" content="TnnDJaWjq71nvLK8WYmDKSGkcgFEIXQy4y3eLKJROMA" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="keywords" content="DV.K Security Cloud Docker K8s" />
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/extend.css" />
    
    <link rel="bookmark"  type="image/x-icon"  href="https://blog.dvkunion.cn/img/logo.png"/>
    <link rel="shortcut icon" href="https://blog.dvkunion.cn/img/logo.png">
    <noscript><link rel="stylesheet" href="/css/noscript.css" /></noscript>
    <style>
        #banner {
            background-image: url("https://blog.dvkunion.cn/img/bg.jpg");
        }
    </style>
<meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="DV.K" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


    <body class="is-preload">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="page-wrapper">
                <!-- Nav -->
        <header id="header">
            <h1 id="logo"><a href="/">DV.K</a></h1>
            <nav id="nav">
                <ul>
                    <li><a href="/">主页</a></li>
                    <li><a href="https://github.com/DVKunion/">Github</a></li>
                    <li><a href="/archives/">文章</a>
                        <ul>
                            <li><a href="/archives/">归档</a><ul>
                                    <a class="archive-link" href="/archives/2023/12/">2023 - 12</a></li><li><a class="archive-link" href="/archives/2023/11/">2023 - 11</a></li><li><a class="archive-link" href="/archives/2023/06/">2023 - 06</a></li><li><a class="archive-link" href="/archives/2023/05/">2023 - 05</a></li><li><a class="archive-link" href="/archives/2023/02/">2023 - 02</a></li><li><a class="archive-link" href="/archives/2022/03/">2022 - 03</a></li><li><a class="archive-link" href="/archives/2022/01/">2022 - 01</a></li><li><a class="archive-link" href="/archives/2020/06/">2020 - 06</a></li><li><a class="archive-link" href="/archives/2019/07/">2019 - 07</a></li><li><a class="archive-link" href="/archives/2019/06/">2019 - 06</a></li><li><a class="archive-link" href="/archives/2019/03/">2019 - 03</a></li><li><a class="archive-link" href="/archives/2019/02/">2019 - 02</a></li><li><a class="archive-link" href="/archives/2019/01/">2019 - 01</a></li><li><a class="archive-link" href="/archives/2018/12/">2018 - 12</a></li><li><a class="archive-link" href="/archives/2018/11/">2018 - 11</a></li><li><a class="archive-link" href="/archives/2018/10/">2018 - 10</a>
                                </ul></li>
                            <li><a href="/tags/">标签</a></li>
                            <li><a href="/categories/">分类</a></li>
                        </ul>
                    </li>
                    <li><a href="/gallery/">图库</a></li>
                    <li><a href="/comments/">留言板</a></li>
                    <li><a href="#" id="link">微信公众号</a></li>
                </ul>
                <div id="message" style="display: none;float: right;">
                    <img src="https://blog.dvkunion.cn/img/qrcode_for_gh_0bac66228b56_258.jpg" class="lazyload" data-srcset="https://blog.dvkunion.cn/img/qrcode_for_gh_0bac66228b56_258.jpg" srcset="/css/images/overlay.gif" alt="微信公众号" />
                </div>
            </nav>
        </header>

        <!-- Banner -->
        

        
        <!-- Main -->
        
        <div id="main" class="wrapper style1">
            <div class="container">
                <header class="major">
                    <h2>CodeQL 踩坑指南</h2>
                    <p>2022-03-24</p>
                    <span id="/2022/03/24/CodeQL-踩坑指南/" class="leancloud_visitors" data-flag-title="CodeQL 踩坑指南">
                        <em class="post-meta-item-text">阅读量 - </em>
                        <i class="leancloud-visitors-count"></i>
                         <p>文章共计 - 2.9k 字 阅读需要 - 13 分钟</p>
                    </span>
                </header>
                <!-- Content -->
                <section id="content">
                    <div class ="post_page_title_img" style="background-image: url(https://blog.dvkunion.cn/img/1484628225604.jpg);" ></div>
                    <hr>
                    <h1>CodeQL 踩坑指南 - Java</h1>
<!-- split -->
<p>讲解这东西的大师傅们太多了，不班门弄斧了，这里仅针对一些踩过的坑点提供一些自己的解决方案，希望能对一些师傅提供点帮助。</p>
<span id="more"></span>
<h2 id="坑I-Lombok">坑I - Lombok</h2>
<h3 id="场景">场景</h3>
<p>在构建一些小型cms和自己的一些项目时，突然发现构建好的数据库内源码比实际的源码少了一大半，导致很多规则分析的flow直接断掉了，什么规则扫描结果都没有。</p>
<h3 id="原因">原因</h3>
<p>构建好的数据库文件夹下，源码是存放在src.zip下的。通过vscode的插件，将数据库添加后也可以看到构建加载后的源码。通过对比源码，发现丢失的java文件都存在lombok注解（@Data/@Sl4j)。<br>
<img src="https://blog.dvkunion.cn/img/16479334970645.jpg" class="lazyload" data-srcset="https://blog.dvkunion.cn/img/16479334970645.jpg" srcset="/css/images/overlay.gif" alt=""></p>
<p>这里的原因就是由于项目使用了lombok。根据官方<a href="https://github.com/github/codeql/issues/8363">Github Issue</a>可得知，lombok 代码在编译期间使用注释处理器转换为正确的 Java 代码。这会干扰 CodeQL 分析器，该分析器会在源代码转换为有效的 Java 代码之前“查看”源代码，从而导致它跳过此类文件。</p>
<h3 id="解决方案">解决方案</h3>
<p>按照官方的思路，解决方式就是将所有文件还原为不使用lombok的方式。还原的方案主要有两种：</p>
<p><strong>1.通过Lombok.jar 直接还原文件</strong></p>
<p>在官方的<a href="https://github.com/github/codeql/issues/4984#:~:text=Unfortunately%20Lombok%20does%20not%20work%20with%20the%20CodeQL,the%20source%20files%20before%20running%20CodeQL%20as%20follows%3A">Github Issue</a>提供了一种方式。</p>
<p>下载项目对应版本的lombok.jar(或者从External Libraries寻找下载好的依赖jar包)，运行：</p>
<p><code>java -jar lombok.jar delombok . -d &quot;delombok-code&quot;</code><br>
这会将当前目录下的所有使用了lombok的代码还原为不使用的状态，并存放在delombok-code这个目录下。</p>
<p>但是在实际测试中，这种方式不会对项目内关联的代码进行还原，比如自己定义的一些TO类，在这种方式的还原下只会被还原成Object，而不是实际的TO对象。可能会对代码分析造成一定的影响。</p>
<p><strong>2. 使用maven-delombok</strong><br>
这种方式的好处在于可以在maven build的过程中来对lombok进行还原，可以很好的解决依赖关系，不会出现上述还原为未定义的Object的场景。</p>
<p>在pom文件内增加：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">phase</span>&gt;</span>generate-sources<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>delombok<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">addOutputDirectory</span>&gt;</span>false<span class="tag">&lt;/<span class="name">addOutputDirectory</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">sourceDirectory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">sourceDirectory</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/lombok<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>由于将所有的还原lombok指向目录/src/main/lombok，所以在maven编译的时候，我们希望编译的是lombok还原后的目录，这样codeql才能够读取整个有效的过程，所以需要修改sourceDirectory</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sourceDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/lombok</span><br><span class="line">        <span class="tag">&lt;/<span class="name">sourceDirectory</span>&gt;</span></span><br><span class="line">        ......</span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里提供一个脚本, 快速插入lombok-plugins，将脚本放置项目根目录并运行<code>python3 delombok.py ./pom.xml </code>即可。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delbankline</span>(<span class="params">file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = [x <span class="keyword">for</span> x <span class="keyword">in</span> f.readlines() <span class="keyword">if</span> <span class="keyword">not</span> re.search(<span class="string">r&#x27;^\s+$&#x27;</span>, x)]</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> fw:</span><br><span class="line">        fw.writelines(lines)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delombok</span>(<span class="params">file</span>):</span><br><span class="line">	<span class="keyword">with</span> <span class="built_in">open</span>(file, <span class="string">&#x27;r+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">		lines = f.readlines()</span><br><span class="line">		f.seek(<span class="number">0</span>)</span><br><span class="line">		f.truncate()</span><br><span class="line">		<span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">			<span class="comment"># f.write(line.replace(&#x27;src/main/java&#x27;, &#x27;src/main/lombok&#x27;))</span></span><br><span class="line">			line = line.replace(<span class="string">&quot;&lt;directory&gt;$&#123;project.basedir&#125;/src/main&lt;/directory&gt;&quot;</span>,</span><br><span class="line">								<span class="string">&quot;&lt;directory&gt;$&#123;project.basedir&#125;/src/main/lombok&lt;/directory&gt;&quot;</span>)</span><br><span class="line">			line = line.replace(<span class="string">&#x27;src/main/java&#x27;</span>, <span class="string">&#x27;src/main/lombok&#x27;</span>)</span><br><span class="line">			f.write(line)</span><br><span class="line"></span><br><span class="line">	tree = ET.ElementTree()</span><br><span class="line">	<span class="comment"># 去掉ns0标签</span></span><br><span class="line">	XML_NS_NAME = <span class="string">&quot;&quot;</span></span><br><span class="line">	XML_NS_VALUE = <span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="line">	ET.register_namespace(XML_NS_NAME, XML_NS_VALUE)</span><br><span class="line">	tree.parse(file)</span><br><span class="line">	root = tree.getroot()</span><br><span class="line">	pre = (re.split(<span class="string">&#x27;project&#x27;</span>, root.tag))[<span class="number">0</span>]</span><br><span class="line">	<span class="comment"># 生成元素</span></span><br><span class="line">	sourceDirectory = ET.Element(<span class="string">&quot;sourceDirectory&quot;</span>)</span><br><span class="line">	goal = ET.Element(<span class="string">&quot;goal&quot;</span>)</span><br><span class="line">	phase = ET.Element(<span class="string">&quot;phase&quot;</span>)</span><br><span class="line">	groupId = ET.Element(<span class="string">&quot;groupId&quot;</span>)</span><br><span class="line">	artifactId = ET.Element(<span class="string">&quot;artifactId&quot;</span>)</span><br><span class="line">	version = ET.Element(<span class="string">&quot;version&quot;</span>)</span><br><span class="line">	<span class="comment"># 赋值</span></span><br><span class="line">	sourceDirectory.text = <span class="string">&quot;$&#123;project.basedir&#125;/src/main/lombok&quot;</span></span><br><span class="line">	goal.text = <span class="string">&quot;delombok&quot;</span></span><br><span class="line">	phase.text = <span class="string">&quot;generate-sources&quot;</span></span><br><span class="line">	groupId.text = <span class="string">&quot;org.projectlombok&quot;</span></span><br><span class="line">	artifactId.text = <span class="string">&quot;lombok-maven-plugin&quot;</span></span><br><span class="line">	version.text = <span class="string">&quot;1.18.4.0&quot;</span></span><br><span class="line">	<span class="comment"># 打包</span></span><br><span class="line">	goals = ET.Element(<span class="string">&quot;goals&quot;</span>)</span><br><span class="line">	goals.append(goal)</span><br><span class="line">	addOutputDirectory = ET.Element(<span class="string">&quot;addOutputDirectory&quot;</span>)</span><br><span class="line">	addOutputDirectory.text = <span class="string">&quot;false&quot;</span></span><br><span class="line">	sourceDirectory2 = ET.Element(<span class="string">&quot;sourceDirectory&quot;</span>)</span><br><span class="line">	sourceDirectory2.text = <span class="string">&quot;src/main/java&quot;</span></span><br><span class="line">	outputDirectory = ET.Element(<span class="string">&quot;outputDirectory&quot;</span>)</span><br><span class="line">	outputDirectory.text = <span class="string">&quot;$&#123;project.basedir&#125;/src/main/lombok&quot;</span></span><br><span class="line">	encoding = ET.Element(<span class="string">&quot;encoding&quot;</span>)</span><br><span class="line">	encoding.text = <span class="string">&quot;UTF-8&quot;</span></span><br><span class="line">	configuration = ET.Element(<span class="string">&quot;configuration&quot;</span>)</span><br><span class="line">	configuration.append(encoding)</span><br><span class="line">	configuration.append(addOutputDirectory)</span><br><span class="line">	configuration.append(sourceDirectory2)</span><br><span class="line">	configuration.append(outputDirectory)</span><br><span class="line">	execution = ET.Element(<span class="string">&quot;execution&quot;</span>)</span><br><span class="line">	execution.append(phase)</span><br><span class="line">	execution.append(goals)</span><br><span class="line">	execution.append(configuration)</span><br><span class="line">	executions = ET.Element(<span class="string">&quot;executions&quot;</span>)</span><br><span class="line">	executions.append(execution)</span><br><span class="line">	plugin = ET.Element(<span class="string">&quot;plugin&quot;</span>)</span><br><span class="line">	plugin.append(groupId)</span><br><span class="line">	plugin.append(artifactId)</span><br><span class="line">	plugin.append(version)</span><br><span class="line">	plugin.append(executions)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 多条件判断</span></span><br><span class="line">	build = root.find(pre + <span class="string">&quot;build&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> build <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">		build = ET.Element(<span class="string">&quot;build&quot;</span>)</span><br><span class="line">		root.append(build)</span><br><span class="line">	build.insert(<span class="number">0</span>, sourceDirectory)</span><br><span class="line">	plugins = build.find(pre + <span class="string">&quot;plugins&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> plugins <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">		plugins = ET.Element(<span class="string">&quot;plugins&quot;</span>)</span><br><span class="line">		build.insert(<span class="number">0</span>, plugins)</span><br><span class="line">	plugins.insert(<span class="number">0</span>, plugin)</span><br><span class="line">	<span class="comment"># 写入</span></span><br><span class="line">	tree.write(file, encoding=<span class="string">&quot;utf-8&quot;</span>, xml_declaration=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">relombok</span>(<span class="params">file</span>):</span><br><span class="line">	<span class="comment">#删除自带的Lombok插件</span></span><br><span class="line">	tree = ET.ElementTree()</span><br><span class="line">	<span class="comment"># 去掉ns0标签</span></span><br><span class="line">	XML_NS_NAME = <span class="string">&quot;&quot;</span></span><br><span class="line">	XML_NS_VALUE = <span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="line">	ET.register_namespace(XML_NS_NAME, XML_NS_VALUE)</span><br><span class="line">	tree.parse(file)</span><br><span class="line">	root = tree.getroot()</span><br><span class="line">	pre = (re.split(<span class="string">&#x27;project&#x27;</span>, root.tag))[<span class="number">0</span>]</span><br><span class="line">	build = root.find(pre + <span class="string">&quot;build&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> build <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	plugins = build.find(pre + <span class="string">&quot;plugins&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> plugins <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> <span class="built_in">len</span>(plugins)==<span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	<span class="keyword">for</span> plugin <span class="keyword">in</span> plugins:</span><br><span class="line">		<span class="keyword">for</span> child <span class="keyword">in</span> plugin:</span><br><span class="line">			<span class="keyword">if</span> child.text == <span class="string">&quot;lombok-maven-plugin&quot;</span>:</span><br><span class="line">				plugins.remove(plugin)</span><br><span class="line">	<span class="comment"># 写入</span></span><br><span class="line">	tree.write(file, encoding=<span class="string">&quot;utf-8&quot;</span>, xml_declaration=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    file = sys.argv[<span class="number">1</span>]</span><br><span class="line">    delbankline(file)</span><br><span class="line">    relombok(file)</span><br><span class="line">    delombok(file)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;finish!!&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="坑II-扩展文件">坑II - 扩展文件</h2>
<h3 id="场景-2">场景</h3>
<p>在看官方提供的ql规则时候，有一个特殊的规则引起了注意：<a href="https://github.com/github/codeql/blob/main/java/ql/src/experimental/Security/CWE/CWE-089/MyBatisMapperXmlSqlInjection.ql">MyBatisMapperXmlSqlInjection.ql</a></p>
<p>他做的事情是扫描Mapper配置Mybatis XML的${}的SQL注入，但是在我们的源代码中，完全没有看到相关的Mybatis的Mapper XML文件。所以规则扫描一直无效。</p>
<h3 id="原因-2">原因</h3>
<p>原因归结于我们没有把对应的xml文件加入到我们的数据库中，在默认的配置中，codeql仅加载了四种xml文件，分别为：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AndroidManifest.xml</span><br><span class="line">pom.xml</span><br><span class="line">struts.xml</span><br><span class="line">web.xml</span><br></pre></td></tr></table></figure>
<h3 id="解决方案-2">解决方案</h3>
<p>结局方案主要有两种方式。<br>
<strong>1.拆分<code>codeql database create</code></strong><br>
这种方式是在官方的Github Issue 发现的，将codeql database create拆分为几个步骤，并在中间的过程增加配置。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">codeql database init --source-root &lt;YourSourcePath&gt; --language java &lt;YourDBPath&gt;</span><br><span class="line">codeql database trace-command --working-dir=&lt;YourSourcePath&gt; &lt;YourDBPath&gt; &lt;BuildCommand&gt;</span><br><span class="line">codeql database index-files --language properties --include-extension .properties --working-dir=&lt;YourSourcePath&gt; --exclude=target &lt;YourDBPath&gt;</span><br><span class="line">codeql database index-files --language xml --include-extension .xml --working-dir=&lt;YourSourcePath&gt; --exclude=target &lt;YourDBPath&gt;</span><br><span class="line">codeql database finalize &lt;YourDBPath&gt;</span><br></pre></td></tr></table></figure>
<p><strong>2.修改<code>pre-finalize</code></strong><br>
这里参考了<a href="https://mp.weixin.qq.com/s/egjA2xFm_ziGHjJ7IxOCbg">楼兰师傅的文章</a>学到了一种新的方式。<br>
上面这种方法在日常的使用中很麻烦，每次构建分析前还得运行脚本来构建。因此这种方法与方法1对比，提升了很大的便捷性。</p>
<p>这种方法只提供xml文件的扩展，如果需要扩展其他类型文件，还需要自己手动增加。(因为 --language 参数不同）</p>
<p><strong>windows:</strong><br>
在codeql-cli/java/tools/pre-finalize.cmd插入<code>--include &quot;**/resources/**/*.xml&quot; ^ </code><br>
<img src="https://blog.dvkunion.cn/img/16479343916145.jpg" class="lazyload" data-srcset="https://blog.dvkunion.cn/img/16479343916145.jpg" srcset="/css/images/overlay.gif" alt=""></p>
<p><strong>linux:</strong><br>
在codeql-cli/java/tools/pre-finalize.sh插入<code>--include &quot;**/resources/**/*.xml&quot;</code><br>
<img src="https://blog.dvkunion.cn/img/16479342964394.jpg" class="lazyload" data-srcset="https://blog.dvkunion.cn/img/16479342964394.jpg" srcset="/css/images/overlay.gif" alt=""></p>
<p><strong>加入properties扩展：</strong><br>
linux为例：<br>
在codeql-cli/java/tools/pre-finalize.sh的结尾找到：<code>if [ &quot;$&#123;LGTM_INDEX_PROPERTIES_FILES:-false&#125;&quot; == &quot;true&quot; ]</code><br>
删除掉这个if判断，即可默认加载properties。</p>
<p>注意，这种方法都加入了size-limit的限制，.xml默认限制10MB，.properties默认限制5MB。</p>
<h2 id="坑III-分析缓慢">坑III - 分析缓慢</h2>
<h3 id="场景-3">场景</h3>
<p>在一些巨型项目中，一次构建+分析可能需要花费10-15分钟，如果在构建的过程中发现忘记加载某些文件，这个过程就要再来一次，重复几次，一天的时间就无了。</p>
<h3 id="原因-3">原因</h3>
<p>大型的项目构建速度缓慢，规则分析也很缓慢。</p>
<h3 id="解决方案-3">解决方案</h3>
<p><strong>使用mvnd 来代替mvn提速</strong><br>
因为我测试的项目大部分使用mvn管理，而在codeql中，mvn默认的构建命令为：<br>
<code>mvn clean package -f &quot;pom.xml&quot; -B -V -e -Dfindbugs.skip -Dcheckstyle.skip -Dpmd.skip=true -Denforcer.skip -Dmaven.javadoc.skip -DskipTests -Dmaven.test.skip.exec -Dlicense.skip=true -Drat.skip=true </code></p>
<p>首先下载并安装<a href="https://github.com/apache/maven-mvnd">mvnd</a>, 官方的手册已经比较清晰。</p>
<p>然后修改codeql构建命令，并使用mvnd进行构建<br>
<code>codeql database create codeqlDB --language=java --command=&quot;mvnd clean package -f &quot;pom.xml&quot; -B -V -e -Dfindbugs.skip -Dcheckstyle.skip -Dpmd.skip=true -Denforcer.skip -Dmaven.javadoc.skip -DskipTests -Dmaven.test.skip.exec -Dlicense.skip=true -Drat.skip=true</code></p>
<p>如果mvnd没有配置的话，还需要使用<code>-s settings.xml</code>指定mvn的setting配置文件。</p>
<p>大概优化的时间在20-30s左右，不同的项目优化效果不同。</p>
<p><strong>规则分析参数调优</strong><br>
对于经常需要用到的规则，codeql支持生成qlo的缓存文件，这样下次再分析其他数据库时，就不需要再次compile而是直接进入规则分析了。<br>
<code>codeql query compile --warnings=hide --fast-compilation --dump-qlo</code><br>
对应目录下会生成规则同名的qlo文件。这样在下次分析这个ql时，codeql会自动找到这个qlo作为缓存，加快了compile的过程。</p>
<h2 id="优化I-python库">优化I - python库</h2>
<h3 id="场景-4">场景</h3>
<p>在经历上述坑点之后，我的数据库构建已经成为了一个很复杂的过程。经常需要各种脚本来辅助。脚本的代码就会出现很丑陋的:<code>os.system(&quot;codeql database xxxxxx ......&quot;)</code>, 令人难以忍受。</p>
<h3 id="解决方案-4">解决方案</h3>
<p>偶然在Github发现了一个非官方的<a href="https://github.com/AlexAltea/codeql-python">python-codeql库</a>, 封装了大量常用的codeql操作。<br>
安装：<br>
<code>pip3 install git+https://github.com/AlexAltea/codeql-python.git</code><br>
使用：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> codeql</span><br><span class="line"></span><br><span class="line"><span class="comment"># Open databases from files or folders</span></span><br><span class="line">db = codeql.Database(<span class="string">&#x27;path/to/db.zip&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Queries return a CSV-like array of arrays</span></span><br><span class="line">results = db.query(<span class="string">&#x27;select &quot;Hello&quot;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span>(results[<span class="number">0</span>][<span class="number">1</span>] == <span class="string">&#x27;Hello&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Queries with external libraries are supported as well</span></span><br><span class="line">codeql.set_search_path(<span class="string">&#x27;path/to/codeql&#x27;</span>)</span><br><span class="line">results = db.query(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    import cpp</span></span><br><span class="line"><span class="string">    from BlockStmt block    </span></span><br><span class="line"><span class="string">    select block</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create temporary databases from inlined sources</span></span><br><span class="line">db = codeql.Database.from_cpp(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    int main() &#123;</span></span><br><span class="line"><span class="string">        return 1337 + 1337 + 1337;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line">results = db.query(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    import cpp</span></span><br><span class="line"><span class="string">    from Literal literal where</span></span><br><span class="line"><span class="string">        literal.getType() instanceof IntType and</span></span><br><span class="line"><span class="string">        literal.getValue().toInt() = 1337</span></span><br><span class="line"><span class="string">    select literal</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(results[<span class="number">1</span>:]) == <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h2 id="优化II-部分规则Demo">优化II - 部分规则Demo</h2>
<p>有了坑II的支持，现在已经可以扫描如spring boot内的配置文件了。例如H2-Console的JNDI注入。</p>
<p>在这个规则中，检测了两个事情：</p>
<ol>
<li>是否存在com.h2database.h2这个jar.</li>
<li>是否开启了spring.h2.console.enabled</li>
</ol>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">import java</span><br><span class="line">import semmle.code.configfiles.ConfigFiles</span><br><span class="line">import semmle.code.xml.MavenPom</span><br><span class="line"></span><br><span class="line">private class H2databaseDependency extends Dependency &#123;</span><br><span class="line">  H2databaseDependency() &#123;</span><br><span class="line">    this.getAChild(&quot;groupId&quot;).getTextValue() <span class="operator">=</span> &quot;com.h2database&quot; <span class="keyword">and</span></span><br><span class="line">    this.getAChild(&quot;artifactId&quot;).getTextValue() <span class="operator">=</span> &quot;h2&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ApplicationProperties extends ConfigPair &#123;</span><br><span class="line">  ApplicationProperties() &#123; this.getFile().getBaseName() <span class="operator">=</span> &quot;application.properties&quot; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> H2databaseDependency dependency, ApplicationProperties ap</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">  ap.getFile()</span><br><span class="line">      .getParentContainer()</span><br><span class="line">      .getAbsolutePath()</span><br><span class="line">      .<span class="keyword">matches</span>(dependency.getFile().getParentContainer().getAbsolutePath() <span class="operator">+</span> &quot;%&quot;) <span class="keyword">and</span></span><br><span class="line">  <span class="keyword">exists</span>( <span class="operator">|</span></span><br><span class="line">    ap.getNameElement().getName() <span class="operator">=</span> &quot;spring.h2.console.enabled&quot; <span class="keyword">and</span></span><br><span class="line">    ap.getValueElement().getValue() <span class="operator">=</span> &quot;true&quot;</span><br><span class="line">  ) <span class="keyword">and</span></span><br><span class="line">  <span class="keyword">not</span> ap.getFile().getAbsolutePath().<span class="keyword">matches</span>(&quot;%test/resources%&quot;)</span><br><span class="line"><span class="keyword">select</span> ap, &quot;该配置存在H2 Database JNDI注入漏洞&quot;</span><br></pre></td></tr></table></figure>
<p>这里只是抛砖引玉，有了配置文件，可以快速的对比SCA，来检查是否使用了存在漏洞的三方jar包。</p>
<h2 id="结尾">结尾</h2>
<p>暂时想到的就这些，还有一些从网络上学到的一些小东西就不丢人现眼了...如果有错误或其他的一些小tips，恳求各位师傅指点一二🙇。</p>
<h4 id="参考链接">参考链接</h4>
<blockquote>
<p>1.Github Issue : <a href="https://github.com/github/codeql/issues/8363">https://github.com/github/codeql/issues/8363</a><br>
2.Github Issue : <a href="https://github.com/github/codeql/issues/4984#:~:text=Unfortunately%20Lombok%20does%20not%20work%20with%20the%20CodeQL,the%20source%20files%20before%20running%20CodeQL%20as%20follows%3A">https://github.com/github/codeql/issues/4984#:~:text=Unfortunately Lombok does not work with the CodeQL,the source files before running CodeQL as follows%3A</a><br>
3.MyBatisMapperXmlSqlInjection.ql : <a href="https://github.com/github/codeql/blob/main/java/ql/src/experimental/Security/CWE/CWE-089/MyBatisMapperXmlSqlInjection.ql">https://github.com/github/codeql/blob/main/java/ql/src/experimental/Security/CWE/CWE-089/MyBatisMapperXmlSqlInjection.ql</a><br>
4.楼兰师傅的文章 : <a href="https://mp.weixin.qq.com/s/egjA2xFm_ziGHjJ7IxOCbg">https://mp.weixin.qq.com/s/egjA2xFm_ziGHjJ7IxOCbg</a><br>
7.mvnd : <a href="https://github.com/apache/maven-mvnd">https://github.com/apache/maven-mvnd</a><br>
8.python-codeql库 : <a href="https://github.com/AlexAltea/codeql-python">https://github.com/AlexAltea/codeql-python</a></p>
</blockquote>

                </section>
            </div>
        </div>
        
            <!-- Main -->
    <link rel="stylesheet" href="/css/valine.css" />
    <div class="container">
        <h3 class="board">☡ 留言板 ☡</h3>
        <div id="vcomment">
        </div>
    </div>
    <style>
        #vcomment{
            padding: 1pc;
        }
    </style>
    </div>
    <footer id="footer">
        
        <!--  copyright  -->
        <ul class="copyright">
                <li>总字数: <i>77.7k</i></li>
                <li>访问总量: <span id="/" class="leancloud_visitors" data-flag-title="">
                        <i class="leancloud-visitors-count">0</i>
                </span></li>
        </ul>
        <ul class="copyright">
            <li>&copy;2018-2023 DVK</li><li>Powered by Hexo</li><li>Design: DVK</li>
        </ul>
        
        <ul class="copyright">
                <img style="height: 17px;width: 17px;" src="https://image.3001.net/images/20210606/16229429757102.png" class="lazyload" data-srcset="https://image.3001.net/images/20210606/16229429757102.png" srcset="/css/images/overlay.gif">
                <liICP>鲁ICP备2021028491号</liICP>
        </ul>
        
        
        <!--  script  -->
        <script src="/js/Valine.min.js"></script>
        <script>
                new Valine({
                        el:'#vcomment',
                        appId: 'jEB3oMGUgUvE5Qc3pSwDO1Pg-gzGzoHsz',
                        appKey: 'WgBXad9R6JRSoxTMohDelbFs',
                        visitor: true, // 阅读量统计
                        recordIP: true,
                        tagMeta: ["Master", "Friends", "Anonymous"],
                        master: ["f21bae5bf498b089b545f6f0a986e224"],
                        friends: ["124ee6157335edb1a9b8c9d635ccbb27"],
                        // 设置Bilibili表情包地址
                        emojiCDN: '//i0.hdslb.com/bfs/emote/',
                        // 表情title和图片映射
                        emojiMaps: {"2020":"dc709fac0d361370bcf0d36d32adb97df7c95824.png","tv_白眼":"c1d59f439e379ee50eef488bcb5e5378e5044ea4.png","tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_坏笑":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_难过":"87f46748d3f142ebc6586ff58860d0e2fc8263ba.png","tv_生气":"26702dcafdab5e8225b43ffd23c94ac1ff932654.png","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_斜眼笑":"911f987aa8bc1bee12d52aafe62bc41ef4474e6c.png","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_发怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_惊吓":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png","tv_呕吐":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_疑问":"0793d949b18d7be716078349c202c15ff166f314.png","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_鼓掌":"1d21793f96ef4e6f48b23e53e3b9e42da833a0f6.png","tv_抠鼻":"c666f55e88d471e51bbd9fab9bb308110824a6eb.png","tv_亲亲":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_调皮":"b9c41de8e82dd7a8515ae5e3cb63e898bf245186.png","tv_笑哭":"1abc628f6d4f4caf9d0e7800878f4697abbc8273.png","tv_晕":"5443c22b4d07fb1907ccc610c8e6db254f2461b7.png","tv_点赞":"f85c354995bd99e28fc76c869bfe42ba6438eff4.png","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_睡着":"8b196675b53af58264f383c50ad0945048290b33.png","tv_色":"61822c7e9aae5da76475e7892534545336b23a6f.png","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_无奈":"ea8ed89ee9878f2fece2dda0ea8a5dbfe21b5751.png","tv_再见":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_流汗":"cead1c351ab8d79e9f369605beb90148db0fbed3.png","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_抓狂":"fe31c08edad661d63762b04e17b8d5ae3c71a757.png","tv_黑人问号":"45821a01f51bc867da9edbaa2e070410819a95b2.png","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_打脸":"56ab10b624063e966bfcb76ea5dc4794d87dfd47.png","tv_闭嘴":"c9e990da7f6e93975e25fd8b70e2e290aa4086ef.png","tv_鄙视":"6e72339f346a692a495b123174b49e4e8e781303.png","tv_腼腆":"89712c0d4af73e67f89e35cbc518420380a7f6f4.png","tv_馋":"fc7e829b845c43c623c8b490ee3602b7f0e76a31.png","tv_可爱":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_发财":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_生病":"8b0ec90e6b86771092a498c54f09fc94621c1900.png","tv_流鼻血":"c32d39db2737f89b904ca32700d140a9241b0767.png","tv_尴尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_流泪":"7e71cde7858f0cd50d74b0264aa26db612a8a167.png","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_皱眉":"72ccad6679fea0d14cce648b4d818e09b8ffea2d.png","tv_鬼脸":"0ffbbddf8a94d124ca2f54b360bbc04feb6bbfea.png","tv_调侃":"4bc022533ef31544ca0d72c12c808cf4a1cce3e3.png","tv_目瞪口呆":"0b8cb81a68de5d5365212c99375e7ace3e7891b7.png","2233娘_大笑":"16b8794be990cefa6caeba4d901b934a227ee3b8.png","2233娘_疑问":"0b41f509351958dbb63d472fec0132d1bd03bd14.png","2233娘_吃惊":"d1628c43d35b1530c0504a643ff80b6189fa0a43.png","2233娘_汗":"247cd9df8cdf84b18368c21e3b2dd374e84c0927.png","2233娘_大哭":"476a2a60f6e337b8c0697a592e0aa82781f6b33b.png","2233娘_困惑":"714eeb4eae0d0933b4ff08b7df788b1982f6b940.png","2233娘_耶":"d7178e258a0efc969b65ccc2b1322fb235f5dff4.png","2233娘_怒":"f31953119c51b9748016440ac0b632f779929b37.png","2233娘_卖萌":"ea893aa25355de95ab4f03c2dad3f0c58d0c159e.png","2233娘_委屈":"d9d0bf9d358af8d5761093ec66d4e3f60d963a63.png","2233娘_郁闷":"485203fe7100f2c8fc40b2800a18fe20b35f2f1a.png","2233娘_第一":"3754ee6e5985bd0bd7dfb668981f2a8733398ebd.png","2233娘_喝水":"695bf5429472049b52c1e0de586f8a2511195a23.png","2233娘_吐魂":"e999af499edf38a91ca68b1a9d2f97042c1d6734.png","2233娘_无言":"fdb5870f32cfaf7949e0f88a13f6feba4a48b719.png","热词系列_增加":"142409b595982b8210b2958f3d340f3b47942645.png","热词系列_泪目":"bba3703ab90b7d16fe9dbcb85ed949db687f8331.png","热词系列_保护":"55f8f6445ca7c3170cdfc5b16036abf639ce9b57.png","热词系列_害怕":"d77e2de26da143249f0c0ad7a608c27152c985bf.png","热词系列_爱了爱了":"2a165b555ba20391316366c664ed7891883dc5aa.png","热词系列_问号":"c1d1e76c12180adc8558f47006fe0e7ded4154bb.png","热词系列_吹爆":"b528220f9c37256ed6a37f05bf118e44b08b81e5.png","热词系列_三连":"21f15fe11b7a84d2f2121c16dec50a4e4556f865.png","热词系列_可以":"e08543c71202b36c590094417fcfbb80c3506cd8.png","热词系列_打卡":"a9cf77c78e1b9b40aa3ed4862402fba008ee2f51.png","热词系列_妙啊":"0e98299d7decf5eaffad854977946075c3e91cb8.png","热词系列_这次一定":"a01ca28923daa7cc896c42f27deb4914e20dd572.png","热词系列_AWSL":"c37f88cf799f9badf9d84b7671dc3dd98c0fc0c2.png","热词系列_递话筒":"98e6950e39fbb4dd1c576042063ca632074070ba.png","热词系列_你细品":"535e00658e7e47966f154d3a167fa2365ebc4321.png","热词系列_咕咕":"d8065c2e7ce48c929317a94553499a46fecc262a.png","热词系列_标准结局":"3de98174b510cf7dc5fd1bd08c5d881065e79137.png","热词系列_危":"5cc6c3357c4df544dd8de9d5c5c0cec97c7c9a56.png","热词系列_张三":"255a938f39cea625032b6650036b31aa26c50a3c.png","热词系列_害":"cbe798a194612958537c5282fcca7c3bcd2aa15c.png","热词系列_我裂开了":"29bd57ec4e8952880fea6c9e47aee924e91f10c4.png","热词系列_有内味了":"7ca61680a905b5b6e2e335c630e725b648b03b4d.png","热词系列_猛男必看":"c97064450528a0e45c7e7c365a15fbb13fd61d8c.png","热词系列_奥力给":"c9b8683827ec6c00fea5327c9bec14f581cef2aa.png","热词系列_我哭了":"9e0b3877d649aaf6538fbdd3f937e240a9d808e4.png","热词系列_高产":"9db817cba4a7f4a42398f3b2ec7c0a8e0c247c42.png","热词系列_我酸了":"a8cbf3f6b8cd9377eeb15b9172f3cd683b2e4650.png","热词系列_真香":"e68497c775feaac1c3b1a6cd63a50cfb11b767c4.png","热词系列_我全都要":"d424d1ad8d14c1c9b8367842bc68c658b9229bc1.png","热词系列_神仙UP":"a49e0d0db1e7d35a0f7411be13208951ab448f03.png","热词系列_你币有了":"84820c2b147a8ca02f3c4006b63f76c6313cbfa0.png","热词系列_不愧是你":"9ff2e356797c57ee3b1675ade0883d2d2247be9b.png","热词系列_锤":"35668cc12ae25b9545420e4a85bf21a0bfc03e5d.png","热词系列_秀":"50782fbf5d9b7f48f9467b5c53932981e321eedc.png","热词系列_爷关更":"faad40c56447f1f8abcb4045c17ce159d113d1fd.png","热词系列_有生之年":"f41fdafe2d0fbb8e8bc1598d2cf37e355560103a.png","热词系列_镇站之宝":"24e7a6a6e6383c987215fb905e3ee070aca259b5.png","热词系列_我太男了":"a523f3e4c63e4db1232365765d0ec452f83be97e.png","热词系列_完结撒花":"ea9db62ff5bca8e069cd70c4233353a802835422.png","热词系列_大师球":"f30089248dd137c568edabcb07cf67e0f6e98cf3.png","热词系列_知识盲区":"ccc94600b321a28116081e49ecedaa4ee8728312.png","热词系列_“狼火”":"33ccd3617bfa89e9d1498b13b7542b63f163e5de.png","加油武汉":"eb966aaa5b690d3f9308a9f936f5b5a72a7f956b.png","口罩":"3ad2f66b151496d2a5fb0a8ea75f32265d778dd3.png","鸡腿":"c7860392815d345fa69c4f00ef18d67dccfbd574.png","微笑":"685612eadc33f6bc233776c6241813385844f182.png","笑":"81edf17314cea3b48674312b4364df44d5c01f17.png","呲牙":"b5a5898491944a4268360f2e7a84623149672eb6.png","OK":"4683fd9ffc925fa6423110979d7dcac5eda297f4.png","星星眼":"63c9d1a31c0da745b61cdb35e0ecb28635675db2.png","哦呼":"362bded07ea5434886271d23fa25f5d85d8af06c.png","嫌弃":"de4c0783aaa60ec03de0a2b90858927bfad7154b.png","喜欢":"8a10a4d73a89f665feff3d46ca56e83dc68f9eb8.png","酸了":"92b1c8cbceea3ae0e8e32253ea414783e8ba7806.png","大哭":"2caafee2e5db4db72104650d87810cc2c123fc86.png","害羞":"9d2ec4e1fbd6cb1b4d12d2bbbdd124ccb83ddfda.png","无语":"44667b7d9349957e903b1b62cb91fb9b13720f04.png","疑惑":"b7840db4b1f9f4726b7cb23c0972720c1698d661.png","调皮":"8290b7308325e3179d2154327c85640af1528617.png","喜极而泣":"485a7e0c01c2d70707daae53bee4a9e2e31ef1ed.png","奸笑":"bb84906573472f0a84cebad1e9000eb6164a6f5a.png","偷笑":"6c49d226e76c42cd8002abc47b3112bc5a92f66a.png","大笑":"ca94ad1c7e6dac895eb5b33b7836b634c614d1c0.png","阴险":"ba8d5f8e7d136d59aab52c40fd3b8a43419eb03c.png","捂脸":"6921bb43f0c634870b92f4a8ad41dada94a5296d.png","囧":"12e41d357a9807cc80ef1e1ed258127fcc791424.png","呆":"33ad6000d9f9f168a0976bc60937786f239e5d8c.png","抠鼻":"cb89184c97e3f6d50acfd7961c313ce50360d70f.png","惊喜":"0afecaf3a3499479af946f29749e1a6c285b6f65.png","惊讶":"f8e9a59cad52ae1a19622805696a35f0a0d853f3.png","笑哭":"c3043ba94babf824dea03ce500d0e73763bf4f40.png","妙啊":"b4cb77159d58614a9b787b91b1cd22a81f383535.png","doge":"bba7c12aa51fed0199c241465560dfc2714c593e.png","滑稽":"d15121545a99ac46774f1f4465b895fe2d1411c3.png","吃瓜":"4191ce3c44c2b3df8fd97c33f85d3ab15f4f3c84.png","打call":"431432c43da3ee5aab5b0e4f8931953e649e9975.png","点赞":"1a67265993913f4c35d15a6028a30724e83e7d35.png","鼓掌":"895d1fc616b4b6c830cf96012880818c0e1de00d.png","尴尬":"cb321684ed5ce6eacdc2699092ab8fe7679e4fda.png","冷":"cb0ebbd0668640f07ebfc0e03f7a18a8cd00b4ed.png","灵魂出窍":"43d3db7d97343c01b47e22cfabeca84b4251f35a.png","委屈":"d2f26cbdd6c96960320af03f5514c5b524990840.png","傲娇":"010540d0f61220a0db4922e4a679a1d8eca94f4e.png","疼":"905fd9a99ec316e353b9bd4ecd49a5f0a301eabf.png","吓":"9c10c5ebc7bef27ec641b8a1877674e0c65fea5d.png","生病":"0f25ce04ae1d7baf98650986454c634f6612cb76.png","吐":"06946bfe71ac48a6078a0b662181bb5cad09decc.png","嘘声":"e64af664d20716e090f10411496998095f62f844.png","捂眼":"c5c6d6982e1e53e478daae554b239f2b227b172b.png","思考":"cfa9b7e89e4bfe04bbcd34ccb1b0df37f4fa905c.png","再见":"fc510306bae26c9aec7e287cdf201ded27b065b9.png","翻白眼":"eba54707c7168925b18f6f8b1f48d532fe08c2b1.png","哈欠":"888d877729cbec444ddbd1cf4c9af155a7a06086.png","奋斗":"bb2060c15dba7d3fd731c35079d1617f1afe3376.png","墨镜":"3a03aebfc06339d86a68c2d893303b46f4b85771.png","撇嘴":"531863568e5668c5ac181d395508a0eeb1f0cda4.png","难过":"a651db36701610aa70a781fa98c07c9789b11543.png","抓狂":"4c87afff88c22439c45b79e9d2035d21d5622eba.png","生气":"3195714219c4b582a4fb02033dd1519913d0246d.png","干杯":"8da12d5f55a2c7e9778dcc05b40571979fe208e6.png","爱心":"ed04066ea7124106d17ffcaf75600700e5442f5c.png","锦鲤":"643d6c19c8164ffd89e3e9cdf093cf5d773d979c.png","胜利":"b49fa9f4b1e7c3477918153b82c60b114d87347c.png","加油":"c7aaeacb21e107292d3bb053e5abde4a4459ed30.png","保佑":"fafe8d3de0dc139ebe995491d2dac458a865fb30.png","抱拳":"89516218158dbea18ab78e8873060bf95d33bbbe.png","响指":"1b5c53cf14336903e1d2ae3527ca380a1256a077.png","支持":"3c210366a5585706c09d4c686a9d942b39feeb50.png","拥抱":"41780a4254750cdaaccb20735730a36044e98ef3.png","怪我咯":"07cc6077f7f7d75b8d2c722dd9d9828a9fb9e46d.png","跪了":"f2b3aee7e521de7799d4e3aa379b01be032698ac.png","黑洞":"e90ec4c799010f25391179118ccd9f66b3b279ba.png","老鼠":"8e6fb491eb1bb0d5862e7ec8ccf9a3da12b6c155.png","福到了":"5de5373d354c373cf1617b6b836f3a8d53c5a655.png"}
                })

        </script>
        <script src="/js/jquery.min.js"></script>
        <script src="/js/jquery.scrolly.min.js"></script>
        <script src="/js/jquery.dropotron.min.js"></script>
        <script src="/js/jquery.scrollex.min.js"></script>
        <script src="/js/browser.min.js"></script>
        <script src="/js/breakpoints.min.js"></script>
        <script src="/js/util.js"></script>
        <script src="/js/main.js"></script>
        <script src="/js/lazyload.js"></script>
        
        <script type="text/javascript" src="/js/mouse.js"></script>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>


</html>
